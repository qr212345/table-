<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <title>åº§å¸­ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆç®¡ç†</title>
  <style>
    /* åŸºæœ¬ */
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      overflow: hidden;
      background-color: #f0f0f0;
      color: #222;
      display: flex;
      flex-direction: column;
      height: 100vh;
      transition: background-color 0.3s, color 0.3s;
    }
    /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ */
    body.dark {
      background-color: #121212;
      color: #eee;
    }

    /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
    #header {
      padding: 10px 15px;
      background: #333;
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 10px;
    }
    #header.dark {
      background: #222;
    }

    #header > div,
    #header select,
    #header button,
    #header input[type=password] {
      font-size: 16px;
      border-radius: 4px;
      border: none;
      padding: 6px 12px;
      box-sizing: border-box;
    }
    #header select {
      min-width: 120px;
      cursor: pointer;
    }
    #header button {
      cursor: pointer;
      background-color: #0078d7;
      color: white;
      transition: background-color 0.2s;
    }
    #header button:hover {
      background-color: #005ea3;
    }
    #header input[type=password] {
      width: 160px;
      outline: none;
      border: 1px solid #999;
      color: #333;
    }
    body.dark #header input[type=password] {
      background: #333;
      color: #eee;
      border-color: #555;
    }

    /* ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚¨ãƒªã‚¢ */
    #layoutArea {
      position: relative;
      width: 100vw;
      flex-grow: 1;
      background-color: #fff;
      overflow: auto;
      padding: 10px;
      box-sizing: border-box;
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      transition: background-color 0.3s;
      outline: none;
    }
    body.dark #layoutArea {
      background-color: #222;
    }

    /* ãƒ†ãƒ¼ãƒ–ãƒ« */
    .table {
      position: absolute;
      background-color: gray;
      border: 2px solid black;
      border-radius: 6px;
      text-align: center;
      padding: 10px;
      box-sizing: border-box;
      touch-action: none;
      color: white;
      font-weight: 600;
      user-select: none;
      cursor: default;
      transition: background-color 0.3s, border-color 0.3s;
    }
    body.dark .table {
      border-color: #ccc;
      color: #eee;
    }
    .table.used {
      background-color: #c0392b !important;
      border-color: #e74c3c !important;
    }
    body.dark .table.used {
      background-color: #e74c3c !important;
      border-color: #f1948a !important;
    }

    /* ãƒªã‚µã‚¤ã‚ºãƒãƒ³ãƒ‰ãƒ« */
    .resize-handle {
      position: absolute;
      width: 14px;
      height: 14px;
      background: black;
      right: 0;
      bottom: 0;
      cursor: se-resize;
      border-radius: 2px;
      opacity: 0.6;
      transition: background-color 0.2s;
    }
    .resize-handle:hover {
      background: #0078d7;
    }
    body.dark .resize-handle {
      background: #eee;
      opacity: 0.7;
    }
    body.dark .resize-handle:hover {
      background: #4aa3ff;
    }

    /* ç®¡ç†ãƒ¢ãƒ¼ãƒ‰æ™‚ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚«ãƒ¼ã‚½ãƒ« */
    .table.admin {
      cursor: move;
      box-shadow: 0 0 6px 2px #0078d7aa;
      border-color: #0078d7;
    }
    /* ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚¹ã‚¿ã‚¤ãƒ« */
    .table:focus {
      outline: 3px solid #0078d7;
      z-index: 10;
    }

    /* ç·¨é›†å±¥æ­´ãƒ­ã‚° */
#logArea {
  height: 120px;
  background: #eee;
  font-family: monospace;
  font-size: 12px;
  color: #111;
  overflow-y: auto;
  padding: 8px;
  border-top: 1px solid #ccc;
  user-select: text;
  transition: background-color 0.3s, color 0.3s;
  display: none; /* â† è¿½åŠ ï¼šåˆæœŸã¯éè¡¨ç¤º */
}
body.dark #logArea {
  background: #121212;
  color: #eee;
  border-color: #444;
}


    /* ã‚¹ãƒãƒ›å¯¾å¿œ */
    @media (max-width: 768px) {
      #header {
        font-size: 14px;
        gap: 5px;
      }
      #header > div,
      #header select,
      #header button,
      #header input[type=password] {
        font-size: 14px;
        padding: 5px 8px;
      }
      .table {
        font-size: 12px;
        padding: 6px;
      }
      .resize-handle {
        width: 12px;
        height: 12px;
      }
    }
  </style>
</head>
<body class="light">
  <div id="header" class="light" role="banner">
    <div>
      <button id="toggleAdminBtn" aria-pressed="false" aria-label="ç®¡ç†ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿">ç®¡ç†ãƒ¢ãƒ¼ãƒ‰ OFF</button>
      <input type="password" id="adminPass" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰" aria-label="ç®¡ç†ãƒ¢ãƒ¼ãƒ‰ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰" autocomplete="off" />
      <button id="addTableBtn" style="display:none;" aria-label="åº§å¸­ã‚’è¿½åŠ ">ï¼‹åº§å¸­è¿½åŠ </button>
    </div>
    <select id="roomSelect" aria-label="éƒ¨å±‹é¸æŠ">
      <option value="room1">Room 1</option>
      <option value="room2">Room 2</option>
    </select>
    <button id="themeToggleBtn" aria-label="ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆ">ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰</button>
  </div>
  <main id="layoutArea" tabindex="0" aria-live="polite" aria-label="åº§å¸­ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ"></main>
  <aside id="logArea" aria-live="polite" aria-label="ç·¨é›†å±¥æ­´ãƒ­ã‚°" role="log"></aside>

  <script>
    const ADMIN_PASSWORD = "babanuki123";
    const SYNC_ENDPOINT = "https://script.google.com/macros/s/AKfycbzdn68UJbzKkXZiUJex2fDhGDJp8eniFab-K9MN6zYkBxEPwASUPzTDYlHVVFmk4DA/exec";
    let isAdmin = false;
    let currentRoom = localStorage.getItem("currentRoom") || "room1";
    let dragging = null;
    let resizing = null;
    let offsetX = 0, offsetY = 0;
    let autoSaveTimer = null;
    let layoutData = JSON.parse(localStorage.getItem("layoutData") || "[]");

    // ãƒ­ã‚°è¿½åŠ 
    function addLog(text) {
      const logArea = document.getElementById("logArea");
      const now = new Date();
      const timeStr = now.toLocaleTimeString();
      logArea.textContent = `[${timeStr}] ${text}\n` + logArea.textContent;
    }

    // ç®¡ç†ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿
    document.getElementById("toggleAdminBtn").addEventListener("click", () => {
      const passInput = document.getElementById("adminPass");
      if (passInput.value === ADMIN_PASSWORD) {
        isAdmin = !isAdmin;
        passInput.value = "";
        document.getElementById("toggleAdminBtn").textContent = `ç®¡ç†ãƒ¢ãƒ¼ãƒ‰ ${isAdmin ? "ON" : "OFF"}`;
        document.getElementById("toggleAdminBtn").setAttribute("aria-pressed", isAdmin.toString());
        addLog(`ç®¡ç†ãƒ¢ãƒ¼ãƒ‰ãŒ${isAdmin ? "ON" : "OFF"}ã«åˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã—ãŸ`);
        document.getElementById("addTableBtn").style.display = isAdmin ? "inline-block" : "none";
        
        document.getElementById("logArea").style.display = isAdmin ? "block" : "none";
        
        renderLayout();
      } else {
        alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™");
      }
    });

    // åº§å¸­è¿½åŠ 
    document.getElementById("addTableBtn").addEventListener("click", () => {
      const newId = `table_${Date.now()}`;
      const newTable = {
        id: newId,
        tableId: newId,
        label: `åº§å¸­ ${layoutData.filter(t => t.room === currentRoom).length + 1}`,
        x: 20,
        y: 20,
        width: 80,
        height: 80,
        room: currentRoom,
        used: false
      };
      layoutData.push(newTable);
      addLog(`æ–°ã—ã„åº§å¸­ã€Œ${newTable.label}ã€ã‚’è¿½åŠ ã—ã¾ã—ãŸ`);
      renderLayout();
      markChanged();
    });

    // éƒ¨å±‹åˆ‡æ›¿
    const roomSelect = document.getElementById("roomSelect");
    roomSelect.value = currentRoom;
    roomSelect.addEventListener("change", e => {
      currentRoom = e.target.value;
      localStorage.setItem("currentRoom", currentRoom);
      addLog(`éƒ¨å±‹ãŒ "${currentRoom}" ã«åˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã—ãŸ`);
      renderLayout();
    });

    // ãƒ†ãƒ¼ãƒåˆ‡æ›¿
    const themeToggleBtn = document.getElementById("themeToggleBtn");
    themeToggleBtn.addEventListener("click", () => {
      const body = document.body;
      if(body.classList.contains("light")){
        body.classList.replace("light", "dark");
        themeToggleBtn.textContent = "ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰";
        document.getElementById("header").classList.replace("light", "dark");
        localStorage.setItem("theme", "dark");
        addLog("ãƒ†ãƒ¼ãƒã‚’ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆã¾ã—ãŸ");
      } else {
        body.classList.replace("dark", "light");
        themeToggleBtn.textContent = "ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰";
        document.getElementById("header").classList.replace("dark", "light");
        localStorage.setItem("theme", "light");
        addLog("ãƒ†ãƒ¼ãƒã‚’ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆã¾ã—ãŸ");
      }
    });

    // ãƒ†ãƒ¼ãƒ–ãƒ«ç”Ÿæˆ
function createTable(table) {
  const div = document.createElement("div");
  div.className = "table" + (isAdmin ? " admin" : "");
  div.style.left = table.x + "px";
  div.style.top = table.y + "px";
  div.style.width = table.width + "px";
  div.style.height = table.height + "px";
  div.textContent = table.label || table.tableId || "Table";
  div.dataset.id = table.id;
  if (table.used) div.classList.add("used");
  div.setAttribute("tabindex", "0");
  div.setAttribute("role", "button");
  div.setAttribute("aria-label", `${table.label || table.tableId}${table.used ? " ä½¿ç”¨ä¸­" : " ç©ºã"}`);

  if (isAdmin) {
    div.addEventListener("mousedown", dragStart);
    const resizer = document.createElement("div");
    resizer.className = "resize-handle";
    resizer.addEventListener("mousedown", resizeStart);
    div.appendChild(resizer);
    
    // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã§ç§»å‹•ãƒ»å‰Šé™¤æ“ä½œç”¨ã‚¤ãƒ™ãƒ³ãƒˆè¿½åŠ 
    div.addEventListener("keydown", tableKeyDown);
    
    // ãƒã‚¦ã‚¹å‰Šé™¤ãƒœã‚¿ãƒ³è¿½åŠ 
    const delBtn = document.createElement("button");
    delBtn.textContent = "âœ–";
    delBtn.setAttribute("aria-label", "åº§å¸­ã‚’å‰Šé™¤");
    delBtn.style.position = "absolute";
    delBtn.style.top = "2px";
    delBtn.style.right = "2px";
    delBtn.style.background = "rgba(255, 0, 0, 0.8)";
    delBtn.style.color = "white";
    delBtn.style.border = "none";
    delBtn.style.borderRadius = "50%";
    delBtn.style.width = "20px";
    delBtn.style.height = "20px";
    delBtn.style.cursor = "pointer";
    delBtn.style.fontWeight = "bold";
    delBtn.style.lineHeight = "18px";
    delBtn.style.padding = "0";
    delBtn.addEventListener("click", (e) => {
      e.stopPropagation(); // ãƒ‰ãƒ©ãƒƒã‚°ã¨è¡çªã—ãªã„ã‚ˆã†ã«
      if (confirm(`åº§å¸­ã€Œ${table.label}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) {
        layoutData = layoutData.filter(t => t.id !== table.id);
        addLog(`åº§å¸­ã€Œ${table.label}ã€ã‚’å‰Šé™¤ã—ã¾ã—ãŸ`);
        renderLayout();
        markChanged();
      }
    });
    div.appendChild(delBtn);
  }

  return div;
}


    // ãƒ‰ãƒ©ãƒƒã‚°é–‹å§‹
    function dragStart(e) {
      if(!isAdmin) return;
      if(e.target.classList.contains("resize-handle")) return;
      dragging = e.currentTarget;
      offsetX = e.offsetX;
      offsetY = e.offsetY;
      window.addEventListener("mousemove", dragMove);
      window.addEventListener("mouseup", dragEnd);
      e.preventDefault();
    }
    function dragMove(e) {
      if (!dragging) return;
      dragging.style.left = (e.pageX - offsetX) + "px";
      dragging.style.top = (e.pageY - offsetY) + "px";
      e.preventDefault();
    }
    function dragEnd() {
      if (!dragging) return;
      const id = dragging.dataset.id;
      const table = layoutData.find(t => t.id == id);
      if(table){
        table.x = parseInt(dragging.style.left);
        table.y = parseInt(dragging.style.top);
        markChanged(`åº§å¸­ ${table.label || table.tableId} ã‚’ç§»å‹•ã—ã¾ã—ãŸ`);
      }
      dragging = null;
      window.removeEventListener("mousemove", dragMove);
      window.removeEventListener("mouseup", dragEnd);
    }

    // ãƒªã‚µã‚¤ã‚ºé–‹å§‹
    function resizeStart(e) {
      if(!isAdmin) return;
      resizing = e.currentTarget.parentElement;
      offsetX = e.clientX;
      offsetY = e.clientY;
      window.addEventListener("mousemove", resizeMove);
      window.addEventListener("mouseup", resizeEnd);
      e.stopPropagation();
      e.preventDefault();
    }
    function resizeMove(e) {
      if (!resizing) return;
      let newW = resizing.offsetWidth + (e.clientX - offsetX);
      let newH = resizing.offsetHeight + (e.clientY - offsetY);
      newW = Math.max(newW, 40);
      newH = Math.max(newH, 40);
      resizing.style.width = newW + "px";
      resizing.style.height = newH + "px";
      offsetX = e.clientX;
      offsetY = e.clientY;
      e.preventDefault();
    }
    function resizeEnd() {
      if (!resizing) return;
      const id = resizing.dataset.id;
      const table = layoutData.find(t => t.id == id);
      if(table){
        table.width = parseInt(resizing.style.width);
        table.height = parseInt(resizing.style.height);
        markChanged(`åº§å¸­ ${table.label || table.tableId} ã‚’ãƒªã‚µã‚¤ã‚ºã—ã¾ã—ãŸ`);
      }
      resizing = null;
      window.removeEventListener("mousemove", resizeMove);
      window.removeEventListener("mouseup", resizeEnd);
    }

    // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œã§ç§»å‹•ãƒ»å‰Šé™¤
// ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œã§ç§»å‹•ãƒ»å‰Šé™¤
function tableKeyDown(e) {
  // ç®¡ç†ãƒ¢ãƒ¼ãƒ‰ã§ãªã‘ã‚Œã°ä½•ã‚‚ã—ãªã„
  if (!isAdmin) return;

  const div = e.currentTarget;
  const step = 10;
  let left = parseInt(div.style.left);
  let top = parseInt(div.style.top);
  let changed = false;

  switch (e.key) {
    case "ArrowLeft":
      div.style.left = Math.max(0, left - step) + "px";
      changed = true;
      break;
    case "ArrowRight":
      div.style.left = left + step + "px";
      changed = true;
      break;
    case "ArrowUp":
      div.style.top = Math.max(0, top - step) + "px";
      changed = true;
      break;
    case "ArrowDown":
      div.style.top = top + step + "px";
      changed = true;
      break;
    case "Delete":
    case "Backspace":
      if (confirm(`åº§å¸­ã€Œ${div.textContent}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) {
        const id = div.dataset.id;
        layoutData = layoutData.filter(t => t.id !== id);
        addLog(`åº§å¸­ã€Œ${div.textContent}ã€ã‚’å‰Šé™¤ã—ã¾ã—ãŸ`);
        renderLayout();
        markChanged();
      }
      break;
  }

  if (changed) {
    const id = div.dataset.id;
    const table = layoutData.find(t => t.id == id);
    if (table) {
      table.x = parseInt(div.style.left);
      table.y = parseInt(div.style.top);
      markChanged(`åº§å¸­ ${table.label || table.tableId} ã‚’ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã§ç§»å‹•ã—ã¾ã—ãŸ`);
    }
    e.preventDefault();
  }
}


    // ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
    function renderLayout() {
      const area = document.getElementById("layoutArea");
      area.innerHTML = "";
      layoutData.filter(t => t.room === currentRoom).forEach(table => {
        area.appendChild(createTable(table));
      });
    }

    // å¤‰æ›´ãƒãƒ¼ã‚¯ï¼†è‡ªå‹•ä¿å­˜
    function markChanged(logText) {
      addLog(logText || "å¤‰æ›´ãŒã‚ã‚Šã¾ã—ãŸ");
      if(autoSaveTimer) clearTimeout(autoSaveTimer);
      autoSaveTimer = setTimeout(() => {
        saveLayout();
        addLog("è‡ªå‹•ä¿å­˜ã•ã‚Œã¾ã—ãŸ");
      }, 1000);
    }

    // ä¿å­˜
    function saveLayout() {
      localStorage.setItem("layoutData", JSON.stringify(layoutData)); // ãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚‚ä¿å­˜

      fetch(SYNC_ENDPOINT, {
        method: "POST",
        headers: { "Content-Type": "text/plain" },  // â† ã“ã“ã‚’application/jsonã‹ã‚‰text/plainã¸å¤‰æ›´
        body: JSON.stringify(layoutData)
      })
      .then(res => res.text())
      .then(msg => addLog("ğŸŒ åŒæœŸã‚µãƒ¼ãƒãƒ¼ã«ä¿å­˜ã—ã¾ã—ãŸ: " + msg))
      .catch(err => {
        console.error(err);
        addLog("âŒ åŒæœŸä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ");
      });
    }


    // å¤–éƒ¨ãƒ‡ãƒ¼ã‚¿ã‚’åæ˜ ã—ã¦usageã‚’æ›´æ–°ã™ã‚‹ï¼ˆGASé€£æºæƒ³å®šï¼‰
    function updateTableUsage(usedTables) {
      let updated = false;
      layoutData.forEach(table => {
        const shouldBeUsed = usedTables.includes(table.tableId || table.id);
        if(table.used !== shouldBeUsed){
          table.used = shouldBeUsed;
          updated = true;
        }
      });
      if(updated){
        renderLayout();
        addLog("ä½¿ç”¨çŠ¶æ³ã‚’æ›´æ–°ã—ã¾ã—ãŸ");
      }
    }

    // å¤–éƒ¨GASãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ï¼ˆä¾‹ï¼‰
    function loadExternalUsageData() {
  fetch("https://script.google.com/macros/s/AKfycbzPUOz4eCsZ7RVm4Yf_VPu1OC5nn2yIOPa5U-tT7ZMHpw0FRNsHaqovbX7vSaEHjPc/exec")
    .then(res => res.json())
    .then(data => {
      const usedTableIds = Object.keys(data.tables || {}); // ä¾‹: { table1: {...}, table2: {...} }
      updateTableUsage(usedTableIds);
      addLog("âœ… å¤–éƒ¨ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«æˆåŠŸã—ã¾ã—ãŸ"); // â† æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    })
    .catch(() => addLog("âŒ å¤–éƒ¨ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ"));
}


    // åˆæœŸåŒ–
    window.addEventListener("load", () => {
      document.getElementById("roomSelect").value = currentRoom;
      renderLayout();
      loadExternalUsageData();

      setInterval(loadExternalUsageData, 10000); // 10ç§’ã”ã¨ã«GASã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—
     // ä¸€å®šé–“éš”ã§åŒæœŸã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰æœ€æ–°ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€è‡ªå‹•ã§æ›´æ–°
      setInterval(() => {
        fetch(SYNC_ENDPOINT)
        .then(res => res.json())
        .then(data => {
      // ç¾åœ¨ã® layoutData ã¨æ¯”è¼ƒã—ã€é•ã„ãŒã‚ã‚Œã°æ›´æ–°
       if (JSON.stringify(data) !== JSON.stringify(layoutData)) {
        layoutData = data;
        renderLayout();
        addLog("ğŸ”„ åŒæœŸã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰æœ€æ–°ã®åº§å¸­ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’åæ˜ ã—ã¾ã—ãŸ");
       }
      })
        .catch(err => {
        console.error(err);
        addLog("âŒ åŒæœŸãƒã‚§ãƒƒã‚¯ã«å¤±æ•—ã—ã¾ã—ãŸ");
      });
      }, 10000); // â† 10ç§’ã”ã¨ã«åŒæœŸãƒã‚§ãƒƒã‚¯ï¼ˆå¿…è¦ãªã‚‰æ™‚é–“å¤‰æ›´OKï¼‰

      // ãƒ†ãƒ¼ãƒä¿å­˜å¾©å…ƒ
      const savedTheme = localStorage.getItem("theme") || "light";
      if(savedTheme === "dark"){
        document.body.classList.replace("light", "dark");
        themeToggleBtn.textContent = "ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰";
        document.getElementById("header").classList.replace("light", "dark");
      } else {
        document.body.classList.replace("dark", "light");
        themeToggleBtn.textContent = "ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰";
        document.getElementById("header").classList.replace("dark", "light");
      }
    });

    // ãƒšãƒ¼ã‚¸é›¢è„±å‰ã«ä¿å­˜
    window.addEventListener("beforeunload", () => {
      saveLayout();
    });
  </script>
</body>
</html>
